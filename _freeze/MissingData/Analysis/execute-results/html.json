{
  "hash": "692596e98668c48f77647891bd79a66f",
  "result": {
    "markdown": "---\ntitle: \"Don't impute all missing data: Missing Data Patterns\"\ndate: 08/28/2022\nauthor: Murat Koptur\nkeywords: data science, statistics, missing data\ndescription-meta: \"How to handle the data with missing values?\"\nexecute:\n  freeze: auto\n  echo: false\n  warning: false\n  error: false\nformat: \n   html:\n     df-print: paged\nlisting: true\n---\n\n\n## Missing Data Patterns\n\nA missing data pattern is the structure of observed and missing values in a data set. This is not to be confused with a missing data mechanism, which describes possible relationships between data and an one's propensity for missing values. Patterns describe where the gaps in the data are, whereas mechanisms explain why the values are missing.\n\n![](images/paste-82A43477.png){width=\"400\"}\n\nThe missing values in panel a have been isolated on a single variable in the univariate pattern. This pattern could appear, for example, in an experimental setting where outcome scores for a subset of participants are missing. Panel b depicts a monotone missing data pattern from a longitudinal study in which individuals who have missing data at one measurement event always have missing data at subsequent measurements. The general pattern in panel c is that missing values are scattered all through the entire data matrix. Panel d depicts a planned missing data pattern in which three variables are intentionally left blank for a large number of respondents. Panel e depicts a pattern in which a latent variable is absent across the entire sample.\n\nOne final configuration needs special consideration because it may introduce estimation issues for modern missing data-handling procedures. Because the data provide insufficient support for estimation, I refer to the configuration in panel f as an underidentified missing pattern. This pattern frequently occurs when two categorical variables have unbalanced group sizes and missing data, resulting in very low or even zero cell counts in a cross-tabulation table. Prior to conducting a missing data analysis, it is critical to screen for this configuration.\n\n## Missing Data Mechanisms\n\nAccording to Rubin, there are three different missing data mechanisms:\n\n1.  Missing Completely at Random (MCAR): Values in a data set are missing completely at random (MCAR) if the events that lead to any particular data-item being missing are independent both of observable variables and of unobservable parameters of interest, and occur entirely at random. When data are MCAR, one can do listwise deletion and perfom analysis; the analysis performed on the data is unbiased; however, data are rarely MCAR.\n2.  Missing at Random (MAR): Missing at random (MAR) occurs when the missingness is not random, but where missingness can be fully accounted for by variables where there is complete information. Since MAR is an assumption that is impossible to verify statistically, we must rely on its substantive reasonableness. Depending on the analysis method, these data can still induce parameter bias in analyses due to the contingent emptiness of cells. However, if the parameter is estimated with Full Information Maximum Likelihood, MAR will provide asymptotically unbiased estimates.\n3.  Missing not at Random (MNAR): Missing not at random (MNAR) (also known as nonignorable nonresponse) is data that is neither MAR nor MCAR (i.e. the value of the variable that's missing is related to the reason it's missing). One can try to include as many predictors as possible in a model to get MNAR closer to MAR.\n\nAlso, one can perform multiple imputation (MI) methods in MCAR and MAR cases.\n\n## How to test?\n\n### Distinguish between MNAR and MAR\n\nThere is no statistical test for this, but you can:\n\n-   Use domain knowledge about variables;\n-   Collect more data for explaning missingness;\n-   Do literature search\n\nfor determining the missing data mechanisim.\n\n### Distinguish between MCAR and MAR\n\nGenerally, two methods are preferred:\n\n1.  Little's MCAR test: Maximum likelihood chi-square test for missing completely at random. $H_0$ is that the data is MCAR.\n2.  Dummy variable approach for MCAR: One can create a dummy variable for whether a variable is missing (1 = missing, 0 = observed) and run t-tests (continuous) and chi-square (categorical) tests between this dummy and other variables to see if the missingness is related to the values of other variables.\n\n## Examples\n\nExample dataset from Fox, Negrete-Yankelevich and Sosa (2015):\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\nlibrary(readr)\nlibrary(naniar)\n\nex_data <- read_csv(\"ex_data.csv\", \n     col_types = cols(x_complete = col_factor(levels = c(\"1\", \n         \"2\", \"3\", \"4\")), x_mcar = col_factor(levels = c(\"1\", \n         \"2\", \"3\", \"4\")), x_mar = col_factor(levels = c(\"1\", \n         \"2\", \"3\", \"4\")), x_mnar = col_factor(levels = c(\"1\", \n         \"2\", \"3\", \"4\"))))\nex_data\n```\n````\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"y\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"x_complete\"],\"name\":[2],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"x_mcar\"],\"name\":[3],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"x_mar\"],\"name\":[4],\"type\":[\"fct\"],\"align\":[\"left\"]},{\"label\":[\"x_mnar\"],\"name\":[5],\"type\":[\"fct\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"31.5\",\"2\":\"1\",\"3\":\"1\",\"4\":\"NA\",\"5\":\"1\"},{\"1\":\"33.5\",\"2\":\"2\",\"3\":\"NA\",\"4\":\"NA\",\"5\":\"2\"},{\"1\":\"34.4\",\"2\":\"3\",\"3\":\"3\",\"4\":\"NA\",\"5\":\"3\"},{\"1\":\"35.1\",\"2\":\"1\",\"3\":\"NA\",\"4\":\"1\",\"5\":\"1\"},{\"1\":\"35.4\",\"2\":\"2\",\"3\":\"2\",\"4\":\"2\",\"5\":\"2\"},{\"1\":\"36.7\",\"2\":\"4\",\"3\":\"4\",\"4\":\"4\",\"5\":\"NA\"},{\"1\":\"37.8\",\"2\":\"2\",\"3\":\"2\",\"4\":\"2\",\"5\":\"3\"},{\"1\":\"38.8\",\"2\":\"4\",\"3\":\"4\",\"4\":\"4\",\"5\":\"NA\"},{\"1\":\"40.3\",\"2\":\"3\",\"3\":\"3\",\"4\":\"3\",\"5\":\"3\"},{\"1\":\"41.5\",\"2\":\"4\",\"3\":\"NA\",\"4\":\"4\",\"5\":\"NA\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nDescriptives:\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\nlibrary(finalfit)\n\nres <- ff_glimpse(ex_data, dependent = \"y\", explanatory = c(\"x_complete\", \"x_mcar\", \"x_mar\", \"x_mnar\"))\n\nres$Continuous\nres$Categorical\n```\n````\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"label\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"var_type\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"n\"],\"name\":[3],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"missing_n\"],\"name\":[4],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"missing_percent\"],\"name\":[5],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"mean\"],\"name\":[6],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"sd\"],\"name\":[7],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"min\"],\"name\":[8],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"quartile_25\"],\"name\":[9],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"median\"],\"name\":[10],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"quartile_75\"],\"name\":[11],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"max\"],\"name\":[12],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"y\",\"2\":\"<dbl>\",\"3\":\"10\",\"4\":\"0\",\"5\":\"0.0\",\"6\":\"36.5\",\"7\":\"3.1\",\"8\":\"31.5\",\"9\":\"34.6\",\"10\":\"36.0\",\"11\":\"38.5\",\"12\":\"41.5\",\"_rn_\":\"y\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div><div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"\"],\"name\":[\"_rn_\"],\"type\":[\"\"],\"align\":[\"left\"]},{\"label\":[\"label\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"var_type\"],\"name\":[2],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"n\"],\"name\":[3],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"missing_n\"],\"name\":[4],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"missing_percent\"],\"name\":[5],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"levels_n\"],\"name\":[6],\"type\":[\"int\"],\"align\":[\"right\"]},{\"label\":[\"levels\"],\"name\":[7],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"levels_count\"],\"name\":[8],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"levels_percent\"],\"name\":[9],\"type\":[\"chr\"],\"align\":[\"left\"]}],\"data\":[{\"1\":\"x_complete\",\"2\":\"<fct>\",\"3\":\"10\",\"4\":\"0\",\"5\":\"0.0\",\"6\":\"4\",\"7\":\"\\\"1\\\", \\\"2\\\", \\\"3\\\", \\\"4\\\"\",\"8\":\"2, 3, 2, 3\",\"9\":\"20, 30, 20, 30\",\"_rn_\":\"x_complete\"},{\"1\":\"x_mcar\",\"2\":\"<fct>\",\"3\":\"7\",\"4\":\"3\",\"5\":\"30.0\",\"6\":\"4\",\"7\":\"\\\"1\\\", \\\"2\\\", \\\"3\\\", \\\"4\\\", \\\"(Missing)\\\"\",\"8\":\"1, 2, 2, 2, 3\",\"9\":\"10, 20, 20, 20, 30\",\"_rn_\":\"x_mcar\"},{\"1\":\"x_mar\",\"2\":\"<fct>\",\"3\":\"7\",\"4\":\"3\",\"5\":\"30.0\",\"6\":\"4\",\"7\":\"\\\"1\\\", \\\"2\\\", \\\"3\\\", \\\"4\\\", \\\"(Missing)\\\"\",\"8\":\"1, 2, 1, 3, 3\",\"9\":\"10, 20, 10, 30, 30\",\"_rn_\":\"x_mar\"},{\"1\":\"x_mnar\",\"2\":\"<fct>\",\"3\":\"7\",\"4\":\"3\",\"5\":\"30.0\",\"6\":\"4\",\"7\":\"\\\"1\\\", \\\"2\\\", \\\"3\\\", \\\"4\\\", \\\"(Missing)\\\"\",\"8\":\"2, 2, 3, 0, 3\",\"9\":\"20, 20, 30,  0, 30\",\"_rn_\":\"x_mnar\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nPlot of missingness:\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\nmissing_plot(ex_data, dependent = \"y\", explanatory = c(\"x_complete\", \"x_mcar\", \"x_mar\", \"x_mnar\"))\n```\n````\n\n::: {.cell-output-display}\n![](Analysis_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\nMissingness patterns:\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\nmissing_pattern(ex_data, dependent = \"y\", explanatory = c(\"x_complete\", \"x_mcar\", \"x_mar\", \"x_mnar\"))\n```\n````\n\n::: {.cell-output .cell-output-stdout}\n```\n  y x_complete x_mcar x_mar x_mnar  \n3 1          1      1     1      1 0\n2 1          1      1     1      0 1\n2 1          1      1     0      1 1\n1 1          1      0     1      1 1\n1 1          1      0     1      0 2\n1 1          1      0     0      1 2\n  0          0      3     3      3 9\n```\n:::\n\n::: {.cell-output-display}\n![](Analysis_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nThere are six missingness pattern on the data.\n\nCompare:\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\nmissing_pairs(ex_data, dependent = \"y\", explanatory = c(\"x_complete\", \"x_mcar\", \"x_mar\", \"x_mnar\"), position = \"fill\")\n```\n````\n\n::: {.cell-output-display}\n![](Analysis_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nAnd lastly, we perform Little's MCAR tests:\n\n-   MCAR case:\n\n\n    ::: {.cell}\n    \n    ````{.cell-code}\n    ```{{r}}\n    mcar_test(data.frame(x = ex_data$x_mcar, y = ex_data$y))\n    ```\n    ````\n    \n    ::: {.cell-output-display}\n    `````{=html}\n    <div data-pagedtable=\"false\">\n      <script data-pagedtable-source type=\"application/json\">\n    {\"columns\":[{\"label\":[\"statistic\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"df\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"p.value\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"missing.patterns\"],\"name\":[4],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"0.01947167\",\"2\":\"1\",\"3\":\"0.8890227\",\"4\":\"2\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n      </script>\n    </div>\n    `````\n    :::\n    :::\n\n\n    Fail to reject null hypothesis, data is MCAR.\n\n-   MAR case:\n\n\n    ::: {.cell}\n    \n    ````{.cell-code}\n    ```{{r}}\n    mcar_test(data.frame(x = ex_data$x_mar, y = ex_data$y))\n    ```\n    ````\n    \n    ::: {.cell-output-display}\n    `````{=html}\n    <div data-pagedtable=\"false\">\n      <script data-pagedtable-source type=\"application/json\">\n    {\"columns\":[{\"label\":[\"statistic\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"df\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"p.value\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"missing.patterns\"],\"name\":[4],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"5.517514\",\"2\":\"1\",\"3\":\"0.018827\",\"4\":\"2\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n      </script>\n    </div>\n    `````\n    :::\n    :::\n\n\n    Reject null, data is not MCAR.\n\n-   MNAR case:\n\n\n    ::: {.cell}\n    \n    ````{.cell-code}\n    ```{{r}}\n    mcar_test(data.frame(x = ex_data$x_mnar, y = ex_data$y))\n    ```\n    ````\n    \n    ::: {.cell-output-display}\n    `````{=html}\n    <div data-pagedtable=\"false\">\n      <script data-pagedtable-source type=\"application/json\">\n    {\"columns\":[{\"label\":[\"statistic\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"df\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"p.value\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"missing.patterns\"],\"name\":[4],\"type\":[\"int\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"3.042448\",\"2\":\"1\",\"3\":\"0.0811135\",\"4\":\"2\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n      </script>\n    </div>\n    `````\n    :::\n    :::\n\n\n    Fail to reject null, data is MCAR (which is wrong).\n    \nFull source code: <https://github.com/mrtkp9993/MyDsProjects/tree/main/MissingData>\n\n## References\n\n-   Enders, C. (2010). *Applied Missing Data Analysis*.\n\n-   RUBIN, D. B. (1976). *Inference and missing data* (Vol. 63, Issue 3, pp. 581--592). Oxford University Press (OUP). https://doi.org/10.1093/biomet/63.3.581\n\n-   Missing data - Wikipedia. (2016, May 13). https://en.wikipedia.org/wiki/Missing_data\n\n-   Little, R. J. A. (1988). A Test of Missing Completely at Random for Multivariate Data with Missing Values (Vol. 83, Issue 404, pp. 1198--1202). Informa UK Limited. https://doi.org/10.1080/01621459.1988.10478722\n\n-   Janz, N. (n.d.). Advanced Handling of Missing Data. Retrieved August 28, 2022, from https://osf.io/updyq/?action=download&version=1\n\n-   Fox, G., Negrete-Yankelevich, S., & Sosa, V. (2015). Ecological Statistics: Contemporary Theory and Application.\n",
    "supporting": [
      "Analysis_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}