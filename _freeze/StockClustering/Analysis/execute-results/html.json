{
  "hash": "c44a32114a96ce3f67ff3d0ec713d1c5",
  "result": {
    "markdown": "---\ntitle: \"Stock Return and Fundamental Clustering & Portfolio Selection\"\ndate: 08/26/2022\nauthor: Murat Koptur\nkeywords: data science, statistics, finance, stock markets, portfolio optimization, machine learning\ndescription-meta: \"Better portfolio management & optimization with machine learning / clustering\"\nexecute:\n  freeze: auto\n  echo: false\n  warning: false\n  error: false\nformat: \n   html:\n     df-print: paged\nlisting: true\n---\n\n\nWe have following features for BIST30 stocks:\n\n-   Momentum 3-months, 6-months, 1-year\n\n-   Volatility 1-year, 2-year, 3-year\n\n-   Price-To-Book Ratio\n\n-   Market Capitalization\n\n-   Return On Equity\n\n-   Earnings Growth\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"stock\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"return1y\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"return2y\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"return3y\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"momentum_3m\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"momentum_6m\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"momentum_1y\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"volatility_1y\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"volatility_2y\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"volatility_3y\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"priceToBook\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"marketCap\"],\"name\":[12],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"returnOnEquity\"],\"name\":[13],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"earningsGrowth\"],\"name\":[14],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"TUPRS.IS\",\"2\":\"0.8002226\",\"3\":\"1.1511775\",\"4\":\"0.9987367\",\"5\":\"0.23728144\",\"6\":\"0.57759733\",\"7\":\"0.8002226\",\"8\":\"59.5179489\",\"9\":\"68.0682894\",\"10\":\"60.2054672\",\"11\":\"3.0962572\",\"12\":\"86069018624\",\"13\":\"0.69121\",\"14\":\"5.243\"},{\"1\":\"VAKBN.IS\",\"2\":\"0.4971455\",\"3\":\"0.2482495\",\"4\":\"0.0989532\",\"5\":\"0.34844448\",\"6\":\"0.59408752\",\"7\":\"0.4971455\",\"8\":\"0.4225866\",\"9\":\"0.4574720\",\"10\":\"0.7448922\",\"11\":\"0.5276930\",\"12\":\"43023728640\",\"13\":\"0.22103\",\"14\":\"4.198\"},{\"1\":\"KRDMD.IS\",\"2\":\"0.3096119\",\"3\":\"0.7765832\",\"4\":\"1.5489084\",\"5\":\"-0.15686049\",\"6\":\"0.06883730\",\"7\":\"0.3096119\",\"8\":\"2.9087381\",\"9\":\"3.4750491\",\"10\":\"4.0152473\",\"11\":\"1.2728418\",\"12\":\"12835080192\",\"13\":\"0.58783\",\"14\":\"0.217\"},{\"1\":\"DOHOL.IS\",\"2\":\"0.6767537\",\"3\":\"0.6111860\",\"4\":\"1.1717035\",\"5\":\"0.29956326\",\"6\":\"0.75619052\",\"7\":\"0.6767537\",\"8\":\"0.6231808\",\"9\":\"0.5841229\",\"10\":\"0.8079047\",\"11\":\"0.8557896\",\"12\":\"13571809280\",\"13\":\"0.36324\",\"14\":\"5.959\"},{\"1\":\"AKBNK.IS\",\"2\":\"0.5414162\",\"3\":\"0.5932975\",\"4\":\"0.4463052\",\"5\":\"0.35978017\",\"6\":\"0.56531043\",\"7\":\"0.5414162\",\"8\":\"1.4566470\",\"9\":\"1.5459579\",\"10\":\"1.4046769\",\"11\":\"0.6063981\",\"12\":\"62295998464\",\"13\":\"0.34285\",\"14\":\"5.225\"},{\"1\":\"TKFEN.IS\",\"2\":\"0.3386060\",\"3\":\"0.5459862\",\"4\":\"0.4729366\",\"5\":\"0.33603662\",\"6\":\"0.42849608\",\"7\":\"0.3386060\",\"8\":\"4.0716242\",\"9\":\"3.9124353\",\"10\":\"3.6112041\",\"11\":\"1.1576780\",\"12\":\"10189800448\",\"13\":\"0.14750\",\"14\":\"2.065\"},{\"1\":\"FROTO.IS\",\"2\":\"0.3950237\",\"3\":\"1.0871587\",\"4\":\"1.7191869\",\"5\":\"0.09042390\",\"6\":\"0.27077501\",\"7\":\"0.3950237\",\"8\":\"53.9871465\",\"9\":\"72.2136784\",\"10\":\"86.9911371\",\"11\":\"10.1918690\",\"12\":\"118923403264\",\"13\":\"1.33964\",\"14\":\"2.707\"},{\"1\":\"GARAN.IS\",\"2\":\"0.8175329\",\"3\":\"0.9125165\",\"4\":\"0.8522854\",\"5\":\"0.54128482\",\"6\":\"0.83453555\",\"7\":\"0.8175329\",\"8\":\"2.8637343\",\"9\":\"3.1331925\",\"10\":\"2.7738157\",\"11\":\"0.9397790\",\"12\":\"105000001536\",\"13\":\"0.32325\",\"14\":\"3.297\"},{\"1\":\"KOZAA.IS\",\"2\":\"0.3780866\",\"3\":\"0.5313129\",\"4\":\"0.9610017\",\"5\":\"-0.14223864\",\"6\":\"0.29301941\",\"7\":\"0.3780866\",\"8\":\"5.5934179\",\"9\":\"5.9706952\",\"10\":\"6.3035278\",\"11\":\"1.8659098\",\"12\":\"10206503936\",\"13\":\"0.28619\",\"14\":\"-0.347\"},{\"1\":\"HALKB.IS\",\"2\":\"0.4580140\",\"3\":\"0.2451225\",\"4\":\"0.1809201\",\"5\":\"0.20817897\",\"6\":\"0.48726250\",\"7\":\"0.4580140\",\"8\":\"0.4939186\",\"9\":\"0.4554376\",\"10\":\"0.6480458\",\"11\":\"0.5318118\",\"12\":\"35429822464\",\"13\":\"0.11143\",\"14\":\"7.206\"},{\"1\":\"TCELL.IS\",\"2\":\"0.1888440\",\"3\":\"0.3995245\",\"4\":\"0.5987489\",\"5\":\"0.14227468\",\"6\":\"0.08305014\",\"7\":\"0.1888440\",\"8\":\"2.2698870\",\"9\":\"2.5874545\",\"10\":\"2.9736265\",\"11\":\"1.9794532\",\"12\":\"47111512064\",\"13\":\"0.24837\",\"14\":\"0.667\"},{\"1\":\"KOZAL.IS\",\"2\":\"0.3807059\",\"3\":\"0.5580269\",\"4\":\"0.8242686\",\"5\":\"-0.15251200\",\"6\":\"0.39113161\",\"7\":\"0.3807059\",\"8\":\"29.6022995\",\"9\":\"30.3674046\",\"10\":\"32.9527258\",\"11\":\"1.8956527\",\"12\":\"23393499136\",\"13\":\"0.32466\",\"14\":\"0.072\"},{\"1\":\"VESTL.IS\",\"2\":\"0.1773839\",\"3\":\"0.5894194\",\"4\":\"1.0967689\",\"5\":\"0.10350422\",\"6\":\"0.28345464\",\"7\":\"0.1773839\",\"8\":\"2.1170289\",\"9\":\"4.5238205\",\"10\":\"7.1430942\",\"11\":\"1.0622802\",\"12\":\"10030134272\",\"13\":\"0.23946\",\"14\":\"NA\"},{\"1\":\"YKBNK.IS\",\"2\":\"0.7511537\",\"3\":\"0.8681324\",\"4\":\"1.0840207\",\"5\":\"0.41768226\",\"6\":\"0.69366659\",\"7\":\"0.7511537\",\"8\":\"0.9705257\",\"9\":\"1.0480458\",\"10\":\"0.9624738\",\"11\":\"0.6261181\",\"12\":\"59129352192\",\"13\":\"0.35390\",\"14\":\"4.423\"},{\"1\":\"TTKOM.IS\",\"2\":\"0.2241917\",\"3\":\"0.4106507\",\"4\":\"0.6365716\",\"5\":\"0.09110558\",\"6\":\"0.33036018\",\"7\":\"0.2241917\",\"8\":\"1.2683501\",\"9\":\"1.5800872\",\"10\":\"1.6253149\",\"11\":\"3.1010454\",\"12\":\"37380001792\",\"13\":\"0.41457\",\"14\":\"0.094\"},{\"1\":\"BIMAS.IS\",\"2\":\"0.6288173\",\"3\":\"0.4958227\",\"4\":\"1.0079282\",\"5\":\"0.33179877\",\"6\":\"0.45276876\",\"7\":\"0.6288173\",\"8\":\"12.2729545\",\"9\":\"10.9873320\",\"10\":\"14.5599371\",\"11\":\"7.6672325\",\"12\":\"67496361984\",\"13\":\"0.62101\",\"14\":\"1.314\"},{\"1\":\"PETKM.IS\",\"2\":\"0.5184885\",\"3\":\"0.9631743\",\"4\":\"1.4199330\",\"5\":\"0.27805933\",\"6\":\"0.52491942\",\"7\":\"0.5184885\",\"8\":\"1.4273099\",\"9\":\"2.1124968\",\"10\":\"2.4640475\",\"11\":\"1.9628410\",\"12\":\"33200640000\",\"13\":\"0.56749\",\"14\":\"0.878\"},{\"1\":\"ARCLK.IS\",\"2\":\"0.4321531\",\"3\":\"0.9586075\",\"4\":\"1.3980148\",\"5\":\"-0.08229317\",\"6\":\"0.29797628\",\"7\":\"0.4321531\",\"8\":\"15.4999249\",\"9\":\"17.1292844\",\"10\":\"18.3476991\",\"11\":\"1.9655682\",\"12\":\"44391333888\",\"13\":\"0.15921\",\"14\":\"-0.462\"},{\"1\":\"EREGL.IS\",\"2\":\"0.1773452\",\"3\":\"0.9365126\",\"4\":\"1.6507876\",\"5\":\"-0.14783540\",\"6\":\"0.07868314\",\"7\":\"0.1773452\",\"8\":\"6.4304412\",\"9\":\"8.4556563\",\"10\":\"9.4332825\",\"11\":\"1.0466932\",\"12\":\"100068720640\",\"13\":\"0.30659\",\"14\":\"1.086\"},{\"1\":\"SAHOL.IS\",\"2\":\"0.6975109\",\"3\":\"0.8650248\",\"4\":\"1.1079941\",\"5\":\"0.18137866\",\"6\":\"0.53658048\",\"7\":\"0.6975109\",\"8\":\"4.3756745\",\"9\":\"4.7300268\",\"10\":\"4.3978211\",\"11\":\"0.7472683\",\"12\":\"51148140544\",\"13\":\"0.39955\",\"14\":\"3.725\"},{\"1\":\"EKGYO.IS\",\"2\":\"0.6513680\",\"3\":\"0.6679807\",\"4\":\"1.0639509\",\"5\":\"0.32193205\",\"6\":\"0.72403927\",\"7\":\"0.6513680\",\"8\":\"0.5067701\",\"9\":\"0.4587505\",\"10\":\"0.5443560\",\"11\":\"0.8670900\",\"12\":\"14498035712\",\"13\":\"0.13061\",\"14\":\"0.462\"},{\"1\":\"THYAO.IS\",\"2\":\"1.2474685\",\"3\":\"1.6777136\",\"4\":\"1.5728141\",\"5\":\"0.33417924\",\"6\":\"1.00082694\",\"7\":\"1.2474685\",\"8\":\"15.2741885\",\"9\":\"14.5433336\",\"10\":\"12.8152383\",\"11\":\"0.7127153\",\"12\":\"96185999360\",\"13\":\"0.21375\",\"14\":\"NA\"},{\"1\":\"PGSUS.IS\",\"2\":\"0.8750763\",\"3\":\"1.0029899\",\"4\":\"0.8587303\",\"5\":\"0.35639463\",\"6\":\"0.77917770\",\"7\":\"0.8750763\",\"8\":\"38.7217848\",\"9\":\"38.0808725\",\"10\":\"35.4403626\",\"11\":\"2.9143846\",\"12\":\"20848740352\",\"13\":\"-0.38290\",\"14\":\"NA\"},{\"1\":\"ISCTR.IS\",\"2\":\"0.9065787\",\"3\":\"0.9619983\",\"4\":\"1.0514769\",\"5\":\"0.46127637\",\"6\":\"0.80484081\",\"7\":\"0.9065787\",\"8\":\"1.1987252\",\"9\":\"1.1341378\",\"10\":\"1.0029563\",\"11\":\"0.6189942\",\"12\":\"80154689536\",\"13\":\"0.33295\",\"14\":\"5.590\"},{\"1\":\"KCHOL.IS\",\"2\":\"0.5273870\",\"3\":\"0.8483591\",\"4\":\"0.9080298\",\"5\":\"0.13706347\",\"6\":\"0.41864951\",\"7\":\"0.5273870\",\"8\":\"6.9859762\",\"9\":\"8.9614304\",\"10\":\"8.5066856\",\"11\":\"1.1941967\",\"12\":\"119145472000\",\"13\":\"0.42805\",\"14\":\"3.832\"},{\"1\":\"ASELS.IS\",\"2\":\"0.2458719\",\"3\":\"0.3855811\",\"4\":\"0.9540115\",\"5\":\"0.08762450\",\"6\":\"0.18277113\",\"7\":\"0.2458719\",\"8\":\"3.6438581\",\"9\":\"3.7901496\",\"10\":\"4.7464624\",\"11\":\"2.1085052\",\"12\":\"60876001280\",\"13\":\"0.33974\",\"14\":\"0.640\"},{\"1\":\"TAVHL.IS\",\"2\":\"0.6517835\",\"3\":\"1.0795130\",\"4\":\"0.8338353\",\"5\":\"0.31531129\",\"6\":\"0.62225438\",\"7\":\"0.6517835\",\"8\":\"10.8632952\",\"9\":\"12.0543199\",\"10\":\"10.8608735\",\"11\":\"2.2842455\",\"12\":\"22631309312\",\"13\":\"0.06828\",\"14\":\"NA\"},{\"1\":\"GUBRF.IS\",\"2\":\"0.3309734\",\"3\":\"0.2167389\",\"4\":\"2.4689597\",\"5\":\"0.33292717\",\"6\":\"0.34078059\",\"7\":\"0.3309734\",\"8\":\"13.2465672\",\"9\":\"17.8231465\",\"10\":\"28.5337733\",\"11\":\"32.7149050\",\"12\":\"35337199616\",\"13\":\"0.28873\",\"14\":\"3.672\"},{\"1\":\"SISE.IS\",\"2\":\"0.6244787\",\"3\":\"1.2456992\",\"4\":\"1.5978989\",\"5\":\"0.15510354\",\"6\":\"0.70215748\",\"7\":\"0.6244787\",\"8\":\"5.1696499\",\"9\":\"5.4595959\",\"10\":\"5.4100408\",\"11\":\"3.2930590\",\"12\":\"78479441920\",\"13\":\"0.30006\",\"14\":\"1.732\"},{\"1\":\"SASA.IS\",\"2\":\"0.6893558\",\"3\":\"1.9488104\",\"4\":\"2.9139533\",\"5\":\"0.36690211\",\"6\":\"0.81822174\",\"7\":\"0.6893558\",\"8\":\"11.4939047\",\"9\":\"12.1525902\",\"10\":\"12.7260857\",\"11\":\"19.8804190\",\"12\":\"58786533376\",\"13\":\"0.61790\",\"14\":\"20.255\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nWe need to standardize the features:\n\n\n::: {.cell}\n\n````{.cell-code}\n```{{r}}\nlibrary(scales)\n\ncols <- 5:ncol(data)\n\ndata_scaled <- lapply(data[, cols], function(x) if(is.numeric(x)) rescale(x, to=c(0,1)) else x)\ndata_scaled <- as.data.frame(data_scaled)\ndata_scaled <- cbind(data[,1:4], data_scaled)\ndata_scaled\n```\n````\n\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"stock\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"return1y\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"return2y\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"return3y\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"momentum_3m\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"momentum_6m\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"momentum_1y\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"volatility_1y\"],\"name\":[8],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"volatility_2y\"],\"name\":[9],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"volatility_3y\"],\"name\":[10],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"priceToBook\"],\"name\":[11],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"marketCap\"],\"name\":[12],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"returnOnEquity\"],\"name\":[13],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"earningsGrowth\"],\"name\":[14],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"TUPRS.IS\",\"2\":\"0.8002226\",\"3\":\"1.1511775\",\"4\":\"0.9987367\",\"5\":\"0.564555726\",\"6\":\"0.54588592\",\"7\":\"0.5820613848\",\"8\":\"1.000000000\",\"9\":\"9.422312e-01\",\"10\":\"0.690148441\",\"11\":\"0.0798007668\",\"12\":\"0.696867058\",\"13\":\"0.6235617\",\"14\":\"0.275377709\"},{\"1\":\"VAKBN.IS\",\"2\":\"0.4971455\",\"3\":\"0.2482495\",\"4\":\"0.0989532\",\"5\":\"0.723781948\",\"6\":\"0.56357946\",\"7\":\"0.2988444097\",\"8\":\"0.000000000\",\"9\":\"2.835053e-05\",\"10\":\"0.002319765\",\"11\":\"0.0000000000\",\"12\":\"0.302373571\",\"13\":\"0.3506043\",\"14\":\"0.224936043\"},{\"1\":\"KRDMD.IS\",\"2\":\"0.3096119\",\"3\":\"0.7765832\",\"4\":\"1.5489084\",\"5\":\"0.000000000\",\"6\":\"0.00000000\",\"7\":\"0.1235994941\",\"8\":\"0.042070163\",\"9\":\"4.208034e-02\",\"10\":\"0.040150614\",\"11\":\"0.0231504611\",\"12\":\"0.025706248\",\"13\":\"0.5635457\",\"14\":\"0.032775016\"},{\"1\":\"DOHOL.IS\",\"2\":\"0.6767537\",\"3\":\"0.6111860\",\"4\":\"1.1717035\",\"5\":\"0.653766116\",\"6\":\"0.73751165\",\"7\":\"0.4666831617\",\"8\":\"0.003394415\",\"9\":\"1.793318e-03\",\"10\":\"0.003048682\",\"11\":\"0.0101933836\",\"12\":\"0.032458086\",\"13\":\"0.4331627\",\"14\":\"0.309938698\"},{\"1\":\"AKBNK.IS\",\"2\":\"0.5414162\",\"3\":\"0.5932975\",\"4\":\"0.4463052\",\"5\":\"0.740018808\",\"6\":\"0.53270241\",\"7\":\"0.3402141224\",\"8\":\"0.017498165\",\"9\":\"1.519714e-02\",\"10\":\"0.009952030\",\"11\":\"0.0024452273\",\"12\":\"0.478996494\",\"13\":\"0.4213255\",\"14\":\"0.274508857\"},{\"1\":\"TKFEN.IS\",\"2\":\"0.3386060\",\"3\":\"0.5459862\",\"4\":\"0.4729366\",\"5\":\"0.706009342\",\"6\":\"0.38590426\",\"7\":\"0.1506937128\",\"8\":\"0.061748291\",\"9\":\"4.817562e-02\",\"10\":\"0.035476719\",\"11\":\"0.0195725246\",\"12\":\"0.001463279\",\"13\":\"0.3079174\",\"14\":\"0.121977120\"},{\"1\":\"FROTO.IS\",\"2\":\"0.3950237\",\"3\":\"1.0871587\",\"4\":\"1.7191869\",\"5\":\"0.354201894\",\"6\":\"0.21667377\",\"7\":\"0.2034144493\",\"8\":\"0.906408860\",\"9\":\"1.000000e+00\",\"10\":\"1.000000000\",\"11\":\"0.3002489312\",\"12\":\"0.997964826\",\"13\":\"1.0000000\",\"14\":\"0.152966163\"},{\"1\":\"GARAN.IS\",\"2\":\"0.8175329\",\"3\":\"0.9125165\",\"4\":\"0.8522854\",\"5\":\"1.000000000\",\"6\":\"0.82157377\",\"7\":\"0.5982373517\",\"8\":\"0.041308617\",\"9\":\"3.731634e-02\",\"10\":\"0.025789969\",\"11\":\"0.0128027864\",\"12\":\"0.870362217\",\"13\":\"0.4099469\",\"14\":\"0.181445190\"},{\"1\":\"KOZAA.IS\",\"2\":\"0.3780866\",\"3\":\"0.5313129\",\"4\":\"0.9610017\",\"5\":\"0.020943851\",\"6\":\"0.24054142\",\"7\":\"0.1875872311\",\"8\":\"0.087499782\",\"9\":\"7.685887e-02\",\"10\":\"0.066621010\",\"11\":\"0.0415760396\",\"12\":\"0.001616360\",\"13\":\"0.3884322\",\"14\":\"0.005550997\"},{\"1\":\"HALKB.IS\",\"2\":\"0.4580140\",\"3\":\"0.2451225\",\"4\":\"0.1809201\",\"5\":\"0.522870314\",\"6\":\"0.44895906\",\"7\":\"0.2622771407\",\"8\":\"0.001207067\",\"9\":\"0.000000e+00\",\"10\":\"0.001199464\",\"11\":\"0.0001279639\",\"12\":\"0.232778349\",\"13\":\"0.2869774\",\"14\":\"0.370130810\"},{\"1\":\"TCELL.IS\",\"2\":\"0.1888440\",\"3\":\"0.3995245\",\"4\":\"0.5987489\",\"5\":\"0.428471223\",\"6\":\"0.01525000\",\"7\":\"0.0107453829\",\"8\":\"0.031259651\",\"9\":\"2.971111e-02\",\"10\":\"0.028101342\",\"11\":\"0.0451036331\",\"12\":\"0.339836530\",\"13\":\"0.3664762\",\"14\":\"0.054496307\"},{\"1\":\"KOZAL.IS\",\"2\":\"0.3807059\",\"3\":\"0.5580269\",\"4\":\"0.8242686\",\"5\":\"0.006228641\",\"6\":\"0.34581318\",\"7\":\"0.1900348226\",\"8\":\"0.493773315\",\"9\":\"4.168436e-01\",\"10\":\"0.374893888\",\"11\":\"0.0425000991\",\"12\":\"0.122470087\",\"13\":\"0.4107655\",\"14\":\"0.025775933\"},{\"1\":\"VESTL.IS\",\"2\":\"0.1773839\",\"3\":\"0.5894194\",\"4\":\"1.0967689\",\"5\":\"0.372937702\",\"6\":\"0.23027868\",\"7\":\"0.0000361843\",\"8\":\"0.028673017\",\"9\":\"5.669569e-02\",\"10\":\"0.076332955\",\"11\":\"0.0166086830\",\"12\":\"0.000000000\",\"13\":\"0.3613037\",\"14\":\"NA\"},{\"1\":\"YKBNK.IS\",\"2\":\"0.7511537\",\"3\":\"0.8681324\",\"4\":\"1.0840207\",\"5\":\"0.822955833\",\"6\":\"0.67042514\",\"7\":\"0.5362078178\",\"8\":\"0.009272118\",\"9\":\"8.258399e-03\",\"10\":\"0.004836708\",\"11\":\"0.0030578933\",\"12\":\"0.449975402\",\"13\":\"0.4277404\",\"14\":\"0.235796689\"},{\"1\":\"TTKOM.IS\",\"2\":\"0.2241917\",\"3\":\"0.4106507\",\"4\":\"0.6365716\",\"5\":\"0.355178306\",\"6\":\"0.28060707\",\"7\":\"0.0437767775\",\"8\":\"0.014311842\",\"9\":\"1.567276e-02\",\"10\":\"0.012504329\",\"11\":\"0.0799495278\",\"12\":\"0.250650991\",\"13\":\"0.4629617\",\"14\":\"0.026837863\"},{\"1\":\"BIMAS.IS\",\"2\":\"0.6288173\",\"3\":\"0.4958227\",\"4\":\"1.0079282\",\"5\":\"0.699939184\",\"6\":\"0.41194820\",\"7\":\"0.4218879144\",\"8\":\"0.200529576\",\"9\":\"1.467691e-01\",\"10\":\"0.162129590\",\"11\":\"0.2218129206\",\"12\":\"0.526655820\",\"13\":\"0.5828079\",\"14\":\"0.085726698\"},{\"1\":\"PETKM.IS\",\"2\":\"0.5184885\",\"3\":\"0.9631743\",\"4\":\"1.4199330\",\"5\":\"0.622964612\",\"6\":\"0.48936393\",\"7\":\"0.3187888101\",\"8\":\"0.017001729\",\"9\":\"2.309225e-02\",\"10\":\"0.022206628\",\"11\":\"0.0445875213\",\"12\":\"0.212348751\",\"13\":\"0.5517376\",\"14\":\"0.064681180\"},{\"1\":\"ARCLK.IS\",\"2\":\"0.4321531\",\"3\":\"0.9586075\",\"4\":\"1.3980148\",\"5\":\"0.106807733\",\"6\":\"0.24586001\",\"7\":\"0.2381108344\",\"8\":\"0.255135729\",\"9\":\"2.323614e-01\",\"10\":\"0.205945703\",\"11\":\"0.0446722506\",\"12\":\"0.314907146\",\"13\":\"0.3147155\",\"14\":\"0.000000000\"},{\"1\":\"EREGL.IS\",\"2\":\"0.1773452\",\"3\":\"0.9365126\",\"4\":\"1.6507876\",\"5\":\"0.012927235\",\"6\":\"0.01056432\",\"7\":\"0.0000000000\",\"8\":\"0.101663725\",\"9\":\"1.114885e-01\",\"10\":\"0.102825420\",\"11\":\"0.0161244223\",\"12\":\"0.825168929\",\"13\":\"0.4002752\",\"14\":\"0.074721243\"},{\"1\":\"SAHOL.IS\",\"2\":\"0.6975109\",\"3\":\"0.8650248\",\"4\":\"1.1079941\",\"5\":\"0.484482450\",\"6\":\"0.50187594\",\"7\":\"0.4860801841\",\"8\":\"0.066893370\",\"9\":\"5.956931e-02\",\"10\":\"0.044576155\",\"11\":\"0.0068218167\",\"12\":\"0.376830674\",\"13\":\"0.4542420\",\"14\":\"0.202104552\"},{\"1\":\"EKGYO.IS\",\"2\":\"0.6513680\",\"3\":\"0.6679807\",\"4\":\"1.0639509\",\"5\":\"0.685806422\",\"6\":\"0.70301421\",\"7\":\"0.4429609933\",\"8\":\"0.001424537\",\"9\":\"4.616834e-05\",\"10\":\"0.000000000\",\"11\":\"0.0105444687\",\"12\":\"0.040946594\",\"13\":\"0.2981121\",\"14\":\"0.044601052\"},{\"1\":\"THYAO.IS\",\"2\":\"1.2474685\",\"3\":\"1.6777136\",\"4\":\"1.5728141\",\"5\":\"0.703348895\",\"6\":\"1.00000000\",\"7\":\"1.0000000000\",\"8\":\"0.251315862\",\"9\":\"1.963244e-01\",\"10\":\"0.141947244\",\"11\":\"0.0057483171\",\"12\":\"0.789585285\",\"13\":\"0.3463780\",\"14\":\"NA\"},{\"1\":\"PGSUS.IS\",\"2\":\"0.8750763\",\"3\":\"1.0029899\",\"4\":\"0.8587303\",\"5\":\"0.735169480\",\"6\":\"0.76217628\",\"7\":\"0.6520100546\",\"8\":\"0.648091436\",\"9\":\"5.243361e-01\",\"10\":\"0.403670399\",\"11\":\"0.0741503054\",\"12\":\"0.099148354\",\"13\":\"0.0000000\",\"14\":\"NA\"},{\"1\":\"ISCTR.IS\",\"2\":\"0.9065787\",\"3\":\"0.9619983\",\"4\":\"1.0514769\",\"5\":\"0.885398576\",\"6\":\"0.78971211\",\"7\":\"0.6814481280\",\"8\":\"0.013133664\",\"9\":\"9.458150e-03\",\"10\":\"0.005305002\",\"11\":\"0.0028365688\",\"12\":\"0.642664512\",\"13\":\"0.4155782\",\"14\":\"0.292127238\"},{\"1\":\"KCHOL.IS\",\"2\":\"0.5273870\",\"3\":\"0.8483591\",\"4\":\"0.9080298\",\"5\":\"0.421006856\",\"6\":\"0.37533915\",\"7\":\"0.3271042317\",\"8\":\"0.111064377\",\"9\":\"1.185368e-01\",\"10\":\"0.092106722\",\"11\":\"0.0207070963\",\"12\":\"1.000000000\",\"13\":\"0.4707873\",\"14\":\"0.207269392\"},{\"1\":\"ASELS.IS\",\"2\":\"0.2458719\",\"3\":\"0.3855811\",\"4\":\"0.9540115\",\"5\":\"0.350192130\",\"6\":\"0.12224796\",\"7\":\"0.0640362723\",\"8\":\"0.054509717\",\"9\":\"4.647149e-02\",\"10\":\"0.048609172\",\"11\":\"0.0491130515\",\"12\":\"0.465982767\",\"13\":\"0.4195200\",\"14\":\"0.053193030\"},{\"1\":\"TAVHL.IS\",\"2\":\"0.6517835\",\"3\":\"1.0795130\",\"4\":\"0.8338353\",\"5\":\"0.676323074\",\"6\":\"0.59380175\",\"7\":\"0.4433491985\",\"8\":\"0.176675601\",\"9\":\"1.616383e-01\",\"10\":\"0.119339522\",\"11\":\"0.0545729932\",\"12\":\"0.115484911\",\"13\":\"0.2619272\",\"14\":\"NA\"},{\"1\":\"GUBRF.IS\",\"2\":\"0.3309734\",\"3\":\"0.2167389\",\"4\":\"2.4689597\",\"5\":\"0.701555465\",\"6\":\"0.29178788\",\"7\":\"0.1435612318\",\"8\":\"0.217004857\",\"9\":\"2.420309e-01\",\"10\":\"0.323776282\",\"11\":\"1.0000000000\",\"12\":\"0.231929497\",\"13\":\"0.3899068\",\"14\":\"0.199546266\"},{\"1\":\"SISE.IS\",\"2\":\"0.6244787\",\"3\":\"1.2456992\",\"4\":\"1.5978989\",\"5\":\"0.446846844\",\"6\":\"0.67953564\",\"7\":\"0.4178336748\",\"8\":\"0.080328864\",\"9\":\"6.973636e-02\",\"10\":\"0.056285321\",\"11\":\"0.0859150522\",\"12\":\"0.627311513\",\"13\":\"0.3964843\",\"14\":\"0.105903364\"},{\"1\":\"SASA.IS\",\"2\":\"0.6893558\",\"3\":\"1.9488104\",\"4\":\"2.9139533\",\"5\":\"0.750220046\",\"6\":\"0.80406949\",\"7\":\"0.4784594399\",\"8\":\"0.187346649\",\"9\":\"1.630078e-01\",\"10\":\"0.140915944\",\"11\":\"0.6012551196\",\"12\":\"0.446833599\",\"13\":\"0.5810025\",\"14\":\"1.000000000\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nWe will use K-means method. Let's plot elbow plot:\n\n![](images/paste-1622CD6D.png){width=\"400\"}\n\nWe have four clusters, let's fit model and see results:\n\n| Clusters | N    | R$^{2}$ | AIC       | BIC       | Silhouette |\n|----------|------|---------|-----------|-----------|------------|\n| $4$      | $30$ | $0.606$ | $194.190$ | $250.240$ | $0.310$    |\n\n| Cluster                                           | $1$      | $2$      | $3$      | $4$     |\n|-------------------------------|----------|----------|----------|----------|\n| Size                                              | $17$     | $2$      | $9$      | $2$     |\n| Explained proportion within-cluster heterogeneity | $0.616$  | $0.127$  | $0.192$  | $0.065$ |\n| Within sum of squares                             | $70.320$ | $14.532$ | $21.962$ | $7.376$ |\n| Silhouette score                                  | $0.267$  | $0.029$  | $0.419$  | $0.449$ |\n\n|                         | Value    |\n|-------------------------|----------|\n| Maximum diameter        | $5.696$  |\n| Minimum separation      | $1.664$  |\n| Pearson's γ             | $0.593$  |\n| Dunn index              | $0.292$  |\n| Entropy                 | $1.044$  |\n| Calinski-Harabasz index | $13.343$ |\n\nThere is no negative silhouette score, but second cluster's score is near to zero. It indicates that seperetion is not well.\n\nCluster contents:\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"stock\"],\"name\":[1],\"type\":[\"chr\"],\"align\":[\"left\"]},{\"label\":[\"predicted_cluster\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"TUPRS.IS\",\"2\":\"2\"},{\"1\":\"VAKBN.IS\",\"2\":\"1\"},{\"1\":\"KRDMD.IS\",\"2\":\"3\"},{\"1\":\"DOHOL.IS\",\"2\":\"1\"},{\"1\":\"AKBNK.IS\",\"2\":\"1\"},{\"1\":\"TKFEN.IS\",\"2\":\"1\"},{\"1\":\"FROTO.IS\",\"2\":\"2\"},{\"1\":\"GARAN.IS\",\"2\":\"1\"},{\"1\":\"KOZAA.IS\",\"2\":\"3\"},{\"1\":\"HALKB.IS\",\"2\":\"1\"},{\"1\":\"TCELL.IS\",\"2\":\"3\"},{\"1\":\"KOZAL.IS\",\"2\":\"3\"},{\"1\":\"VESTL.IS\",\"2\":\"3\"},{\"1\":\"YKBNK.IS\",\"2\":\"1\"},{\"1\":\"TTKOM.IS\",\"2\":\"3\"},{\"1\":\"BIMAS.IS\",\"2\":\"1\"},{\"1\":\"PETKM.IS\",\"2\":\"1\"},{\"1\":\"ARCLK.IS\",\"2\":\"3\"},{\"1\":\"EREGL.IS\",\"2\":\"3\"},{\"1\":\"SAHOL.IS\",\"2\":\"1\"},{\"1\":\"EKGYO.IS\",\"2\":\"1\"},{\"1\":\"THYAO.IS\",\"2\":\"1\"},{\"1\":\"PGSUS.IS\",\"2\":\"1\"},{\"1\":\"ISCTR.IS\",\"2\":\"1\"},{\"1\":\"KCHOL.IS\",\"2\":\"1\"},{\"1\":\"ASELS.IS\",\"2\":\"3\"},{\"1\":\"TAVHL.IS\",\"2\":\"1\"},{\"1\":\"GUBRF.IS\",\"2\":\"4\"},{\"1\":\"SISE.IS\",\"2\":\"1\"},{\"1\":\"SASA.IS\",\"2\":\"4\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nLet's look the mean return statistics of each cluster:\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<div data-pagedtable=\"false\">\n  <script data-pagedtable-source type=\"application/json\">\n{\"columns\":[{\"label\":[\"predicted_cluster\"],\"name\":[1],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"mean_1_year_return\"],\"name\":[2],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"std_1_year_return\"],\"name\":[3],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"mean_2_year_return\"],\"name\":[4],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"std_2_year_return\"],\"name\":[5],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"mean_3_year_return\"],\"name\":[6],\"type\":[\"dbl\"],\"align\":[\"right\"]},{\"label\":[\"std_3_year_return\"],\"name\":[7],\"type\":[\"dbl\"],\"align\":[\"right\"]}],\"data\":[{\"1\":\"1\",\"2\":\"0.6711517\",\"3\":\"0.21058568\",\"4\":\"0.8136921\",\"5\":\"0.35593914\",\"6\":\"0.9252774\",\"7\":\"0.4306265\"},{\"1\":\"2\",\"2\":\"0.5976232\",\"3\":\"0.28651890\",\"4\":\"1.1191681\",\"5\":\"0.04526808\",\"6\":\"1.3589618\",\"7\":\"0.5094352\"},{\"1\":\"3\",\"2\":\"0.2793549\",\"3\":\"0.09838898\",\"4\":\"0.6162465\",\"5\":\"0.22339899\",\"6\":\"1.0743424\",\"7\":\"0.3825022\"},{\"1\":\"4\",\"2\":\"0.5101646\",\"3\":\"0.25341461\",\"4\":\"1.0827746\",\"5\":\"1.22475955\",\"6\":\"2.6914565\",\"7\":\"0.3146580\"}],\"options\":{\"columns\":{\"min\":{},\"max\":[10]},\"rows\":{\"min\":[10],\"max\":[10]},\"pages\":{}}}\n  </script>\n</div>\n`````\n:::\n:::\n\n\nMean returns will be better if we select stocks from a bigger stock set like BIST100 or all BIST stocks.\n\nFull source code: <https://github.com/mrtkp9993/MyDsProjects/tree/main/StockClustering>\n\n## References\n\n-   <https://www.investopedia.com/terms/c/cluster_analysis.asp>\n\n-   <https://www.investopedia.com/terms/f/factor-investing.asp>\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<link href=\"../site_libs/pagedtable-1.1/css/pagedtable.css\" rel=\"stylesheet\" />\r\n<script src=\"../site_libs/pagedtable-1.1/js/pagedtable.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}